<div class="bg-gray-100 min-h-screen p-2">
  <h1 class="text-4xl font-bold mt-2 flex justify-center" *ngIf="groupDetails">{{groupDetails.name}}</h1>

  <p class="text-xl m-2 flex justify-center" *ngIf="currentUser async" [ngClass]="{
    'text-red-600': currentUser.balance < 0,
    'text-green-600': currentUser.balance > 0,
  }">
    Your balance: {{currentUser.balance}}
  </p>

  <div class="flex justify-center items-center">
    <ng-container *ngIf="!settle; else settleContent">
      <div *ngIf="balanceWithNames && balanceWithNames.length>0">
        <ul class="mt-4">
          <li *ngFor="let balance of balanceWithNames" class="text-lg text-gray-700 mb-2 p-1 hover:text-blue-500">
            <strong>{{ balance.from }} owes {{ balance.to }}</strong>
            <span class="text-red-600"> ${{ balance.balance | number: '1.2-2' }}</span>
          </li>
        </ul>
        <br>
        <button class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded"
          (click)="settle = true">
          Settle Balance
        </button>
      </div>
    </ng-container>
    <ng-template #settleContent>
      <div>
        <ul class="mt-4">
          <li *ngFor="let balance of balanceWithNames; let i = index" (click)="confirmSettleBalance(i); settle = false"
            class="text-lg text-gray-700 mb-2 p-1 hover:text-green-500 hover:border-black border-2 cursor-pointer">
            <strong>{{ balance.from }} owes {{ balance.to }}</strong>
            <span class="text-red-600"> ${{ balance.balance | number: '1.2-2' }}</span>
          </li>
        </ul>
        <br>

        <button class="bg-red-500 hover.bg-red-700 text-white font-bold py-2 px-4 rounded" (click)="settle = false">
          Cancel
        </button>
      </div>
    </ng-template>
  </div>

<!-- Expense -->

  <div class="container mx-auto p-6 flex justify-center space-x-8">
    <a [routerLink]="['add-expense']" [queryParams]="{ groupId: groupId}">Add Expense</a>

    <router-outlet></router-outlet>
    <app-expense [members]="members$" [groupId]="groupId"></app-expense>
  </div>

<!-- Members -->

  <h2 class="text-2xl font-bold mb-4 flex justify-center">Members</h2>
  <div class="container mx-auto p-6 mt-4 flex justify-center space-x-8">
    <div class="bg-white p-4 rounded text-center flex-1">
      <h2 class="text-2xl font-semibold mb-4">Members in Group</h2>

      <ul>
        <li *ngFor="let member of members$" class="text-lg text-gray-700 mb-2 hover:text-blue-500">
          {{ member.name }}, {{ member.email}}, {{member.balance}}
        </li>
      </ul>
    </div>

    <div class="bg-white p-6 rounded-lg text-center flex-1">
      <h2 class="text-2xl font-bold mb-4">Add New Member</h2>
      <form [formGroup]="createForm" (ngSubmit)="onAddUser()">
        <div class="mb-4">
          <label for="userEmail" class="block text-gray-700">User Email:</label>
          <input type="text" id="userEmail" formControlName="email" required
            class="px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:border-blue-500">
        </div>
        <div class="text-red-600" *ngIf="errorMessage">
          {{ errorMessage }}
        </div>
        <button type="submit"
          class="px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-600 focus:outline-none focus:bg-blue-600">
          Add
        </button>
      </form>
    </div>
  </div>

</div>